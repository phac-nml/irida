/*!
 * Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v4.0.2 - 2014-05-21
 *
 */!function(a,b,c,d){"use strict";var e,f,g,h="wb-date",i="input[type=date]",j=h+"-inited",k="wb-init."+h,l="setfocus.wb",m="wb-picker",n=new Date,o=n.getMonth(),p=n.getFullYear(),q="YYYY-MM-DD",r=!1,s=d.doc,t=function(b){var c,h,k=b.target,l=k.id;if(b.currentTarget===k&&-1===k.className.indexOf(j)){if(d.remove(i),k.className+=" "+j,-1!==k.className.indexOf("picker-field"))return;f||(e=d.i18n,h=e("space"),f={show:e("date-show")+h,selected:e("date-sel"),close:e("close")+h+e("cal").toLowerCase()+h+e("esc-key")}),k.className+=" picker-field",g||(g=a("<div id='"+m+"' class='picker-overlay' role='dialog' aria-hidden='true'></div>"),c=f.close,a("<button type='button' class='picker-close mfp-close overlay-close' title='"+c+"'>&#xd7;<span class='wb-inv'> "+c+"</span></button>").appendTo(g).on("click",function(a){var b=a.which;b&&1!==b||x(g.attr("aria-controls"))}),g.find("a").attr("tabindex","-1"),a("main").after(g)),l&&u(l),r=!0}},u=function(b){var c=a("label").filter("[for='"+b+"']").clone().find(".datepicker-format").remove().end().text(),d=f.show+c,e="<a href='javascript:;' button id='"+b+"-picker-toggle' class='picker-toggle' href='javascript:;' title='"+d+"'><span class='glyphicon glyphicon-calendar'></span><span class='wb-inv'>"+d+"</span></a>";a("#"+b).wrap("<span class='wb-date-wrap'/>").after(e),g.slideUp(0)},v=function(a,b,e,f){var g,h,i,j,k,l,m=c.getElementById(a),n=m.getAttribute("min"),o=m.getAttribute("max"),p=d.date.fromDateISO,q=f.length;for(n=p(n?n:"1800-01-01"),i=n.getDate()-1,o=p(o?o:"2100-01-01"),j=o.getDate(),g=b===n.getFullYear()&&e===n.getMonth(),h=b===o.getFullYear()&&e===o.getMonth(),k=0;k!==q;k+=1)(!g&&!h||g&&k>=i||h&&j>k)&&(l=f[k],l.innerHTML="<a href='javascript:;' tabindex='-1'>"+l.getElementsByTagName("div")[0].innerHTML+"</a>");f.find("a").eq(0).attr("tabindex","0")},w=function(b,d,e,g){var h,i;a(g).removeClass("picker-sel").find(".picker-sel-text").detach(),h=c.getElementById(b).value;try{""!==h&&(i=new Date(h),i.getUTCFullYear()===d&&i.getUTCMonth()===e&&a(g[i.getUTCDate()-1]).addClass("picker-sel").children("a").attr("aria-selected","true").append("<span class='wb-inv picker-sel-text'> ["+f.selected+"]</span>"))}catch(j){}},x=function(b){var e,h=c.getElementById(b),i=a(h),j=h.getAttribute("min"),k=h.getAttribute("max"),n=d.date.fromDateISO,q=n(h.value);j||(j="1800-01-01"),k||(k="2100-01-01"),s.trigger("create.wb-cal",[m,p,o,!0,j,k,void 0,b,b+"-picker-toggle"]),i.after(g),"false"!==g.attr("aria-hidden")?(e=f.close,y(b),g.slideDown("fast").attr("aria-hidden","false"),a("#"+b+"-picker-toggle").attr("title",e).children(".wb-inv").text(e),null!==q?(q.setDate(q.getDate()+1),s.trigger("setFocus.wb-cal",[m,p,o,n(j),n(k),q])):a("#"+m).trigger(l)):(z(b),i.trigger(l))},y=function(b){var c,d,e=a(".picker-field").get(),f=e.length;for(c=0;c!==f;c+=1)d=e[c].id,d!==b&&z(d)},z=function(b){var c=a("#"+b+"-picker-toggle"),d=f.show+a("label[for="+b+"]").clone().find(".datepicker-format").remove().end().text();g.slideUp("fast").attr("aria-hidden","true").trigger("hideGoToFrm.wb-cal"),c.attr("title",d.replace("&#32;"," ")).children(".wb-inv").html(d)},A=function(a,b,c,e){var f=d.string.pad;return e.replace("DD",f(c,2)).replace("D",c).replace("MM",f(b,2)).replace("M",b).replace("YYYY",a).replace("YY",a.toString().substr(2,2))};s.on("timerpoke.wb "+k,i,t),s.on("click vclick touchstart focusin",function(b){var d,e=b.which;return!r||e&&1!==e||(d=c.getElementById(m),null===d||"false"!==d.getAttribute("aria-hidden")||b.target.id===d.id||a.contains(d,b.target))?void 0:(z(d.getAttribute("aria-controls")),!1)}),s.on("keydown displayed.wb-cal","#"+m,function(b,c,d,e){var f=a(this),g=b.type,h=b.which,i=f.attr("aria-controls");switch(g){case"keydown":27===h&&(y(),a("#"+i).trigger(l));break;case"displayed":v(i,c,d,e),w(i,c,d,e),f.trigger(l);break;case"click":case"vclick":case"touchstart":case"focusin":f.attr("aria-hidden")===!1&&(h&&1!==h||(b.stopPropagation?b.stopImmediatePropagation():b.cancelBubble=!0))}}),s.on("click",".picker-toggle",function(a){a.preventDefault();var b,c=a.which;return c&&1!==c?void 0:(b=this.id,x(b.substring(0,b.indexOf("-picker-toggle"))),!1)}),s.on("click",".cal-days a",function(b){var e,f,g,h,i,j,k=b.which;return k&&1!==k?void 0:(e=c.getElementById(m).getAttribute("aria-controls"),f=d.date.fromDateISO(this.getElementsByTagName("time")[0].getAttribute("datetime")),g=f.getFullYear(),h=f.getMonth(),i=f.getDate(),j=a("#"+e),j.val(A(g,h+1,i,q)),w(e,g,h,i),x(e),!1)}),d.add(i)}(jQuery,window,document,wb);